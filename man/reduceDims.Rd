% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reduce_dimensions.R
\name{reduceDims}
\alias{reduceDims}
\title{Reduce dimensions of residual matrix}
\usage{
reduceDims(
  obj,
  method = "SVD",
  n.pcs = 50,
  scaleVar = T,
  num.var = 5000,
  regNum = 5000,
  cor.max = 0.75,
  doL2 = F,
  doL1 = F,
  doSTD = T,
  refit_residuals = F,
  residuals_slotName = "residuals",
  svd_slotName = "PCA",
  verbose = FALSE,
  ...
)
}
\arguments{
\item{obj}{list, object containing "pearson_residuals" output by the function regModel.}

\item{method}{character, string denoting dimension reduction method. Can be one of "SVD" or
"NMF". Defaults to SVD.}

\item{n.pcs}{numeric, number of singular values to calculate.}

\item{regNum}{number of peaks/bins to use for regularization. regNum must be equal or
less than num.vars. Defaults to 5000.}

\item{cor.max}{float, maximum spearman correlation between log10nSites (log10 number of
accessible peaks) and singular value to keep. Singular values with correlations greater than
cor.max are removed. Ranges from 0 to 1. Default set to 0.75.}

\item{doL2}{logical, whether or not to L2 normalize barcodes.}

\item{doL1}{logical, whether or not to L1 normalize barcodes}

\item{refit_residuals}{logical, whether or not to use quasibinomial logistic regression residuals
for num.vars features. Only applicable when num.vars < nrow(obj$counts) and when the normalization
was performed with tfidf. Defaults to FALSE.}

\item{residuals_slotName}{character, character string of the desired residual slotName. Defaults
to "residuals".}

\item{svd_slotName}{character, character string for naming the SVD output in the returned
object. Defaults to "PCA".}

\item{verbose}{logical. Defaults to FALSE.}

\item{...}{Additional arguments to be passed to RcppML::nmf}

\item{scaleVars}{logical, whether or not to scale PCs by variance explained (or to scale
NMF components by scale factors). Default to TRUE.}

\item{num.vars}{number of highly variable ACRs/bins to use for dimensionality reduction.
Variance is stabilized using loess regression between the feature variance and mean.
Defaults to 5000. Set to NULL to use all ACRs/bins. To select features above a specific
stabilized variance value, set num.var to a numeric value less than 100. In all cases,
Socrates will take a minimum of 100 features to perform dimensionality reduction.}

\item{stdLSI}{logical, whether or not to standardize barcodes.}
}
\description{
Run SVD on Pearson residuals using IRLBA.
}
